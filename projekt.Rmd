---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Jan Lampič"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

```{r setup, echo=FALSE, results='hide', message=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme

Za temo anlize sem si izbral svetovni avtomobilski trg. Cilj projekta je primerjava in razvrstitev držav glede na proizvodnjo, prodajo in uporabo določenega tipa avtomobilov, poiskati povezave med danimi količinami z razvitostjo držav (BDP) ter gospodarski vpliv avtomobilskega trga.
Primerjal pa bom tudi posamezna podjetja glede na njihovo proizvodnjo.

***

# Obdelava, uvoz in čiščenje podatkov

```{r tabele, echo=FALSE, message=FALSE}
prodaja <- read.csv2("podatki/urejeni/prodaja.csv")
uporaba <- read.csv2("podatki/urejeni/uporaba.csv")
proizvodnja <- read.csv2("podatki/urejeni/proizvodnja.csv")
proizvajalci<- read.csv2("podatki/urejeni/proizvajalci.csv")
gdp <- read.csv2("podatki/urejeni/gdp.csv")
populacija <- read.csv2("podatki/urejeni/populacija.csv")

```

1.TABELA - prodaja avtomobilov po državah

S spletnega naslova [OICA/SALES](http://www.oica.net/category/sales-statistics/) sem uvozil tabeli o prodanih osebnih avtomobilih ter komercialnih vozilih po državah v letih od 2005 do 2016. 
Podatki so bili v obliki EXCEL (.xlsx). 
Obe tabeli sem uredil v normalizirano obliko ter ju združil.

Stolpci v tabeli:

* Country - država (imenska spremenljivka)
* Type - tip vozila (imenska spremenljivka)
    + PC - passenger car (osebni avtomobil) 
    + CV - commercial vehicle (komercialno vozilo)
* Number - število prodanih avtomobilov (številska spremenljivka)

```{r prodaja}
kable(head(prodaja))
```

2.TABELA - uporaba avtomobilov po državah

Iz spletnega mesta [OICA/USE](http://www.oica.net/category/vehicles-in-use/) sem uvozil tabeli o uporabi osebnih ter komercialnih vozil po državah v letih od 2005 do 2014.
Podatki so bili v obliki EXCEL (.xlsx). Stolpci v tabeli so enaki kot pri zgornji.

```{r uporaba}
kable(head(uporaba))
```

3.TABELA - proizvodnja avtomobilov po državah

Podatke o proizvodnji avtomobilov po državah sem prav tako prenesel iz [OICA/PRODUCTION](http://www.oica.net/category/production-statistics/).Podatki so bili v večji meri v obliki PDF zato sem jih za nadalnje delo pretvoril v EXCEL. Podatke sem najprej uredil v štiri tabele (4 kategorije vozil), kjer vsaka vsebuje podatke o proizvodnji od leta 2004 do 2015. Te sem nato združil v skupno tabelo, pri kateri sem z regularnimi izrazi popravil še  napake v stolpcu Country. 

Stolpci v tabeli:

* Country - država (imenska spremenljivka)
* Type - tip vozila (imenska spremenljivka)
    + PC - passenger car (osebni avtomobil) 
    + CV - commercial vehicle (komercialno vozilo)
    + HT - heavy trucks (tovornjaki)
    + BC - buses and coaches (avtobusi)
* Year - leto (števislka spremenljivka)
* Number - število prodanih avtomobilov (številska spremenljivka)

```{r proizvodnja}
kable(head(proizvodnja))
```

4.TABELA - proizvodnja avtomobilov posameznih proizvajalcev

Podatke o proizvodnji avtomobilov glede na proizvajalca pa sem uvozil iz [WIKI/PRODUCTION](https://en.wikipedia.org/wiki/List_of_manufacturers_by_motor_vehicle_production#2015). Te podatki so bili v obliki HTML. Tabele sem uvozil s pomočjo knjižnice `rvest`, jih pretvoril v standardno obliko ter jih uredil z regularnimi izrazi.

Stolpci v tabeli:

* Group - podjetje oz. proizvajalec (imenska spremenljivka)
* Country - država (imenska spremnljivka)
* Year - leto (številska spremenljivka)
* Number - število proizvedenih avtomobilov (številska spremenljivka)

```{r proizvjalci}
kable(head(proizvajalci))
```

Za nadaljno analizo oz. za lažje primerjanje med državami sem uvozil še podatke o bruto domačem proizvodu ter populaciji posameznih držav.

5.TABELA - bruto domači proizvod držav

Stolpci v tabeli:

* Country - država (imenska spremnljivka)
* Year - leto (številska spremenljivka)
* GDPr - bruto domači proizvod (številska spremenljivka)


```{r gdp}
kable(head(gdp))
```

6.TABELA - populacija

Podatke o številu prebivalcev posamezne države skozi leta sem uvozil iz spletne strani [The World bank](http://databank.worldbank.org/data/reports.aspx?source=health-nutrition-and-population-statistics#). 

Stolpci v tabeli:

* Country - država (imenska spremnljivka)
* Year - leto (številska spremenljivka)
* Number - števio ljudi (številska spremenljivka)

```{r populacija}
kable(head(populacija))
```

# Pregled in vizualizacija podatkov

Za lažje izvajanje analize, sem podatke predstavil s pomočjo grafov. Iz grafov lahko razberemo trende gibanja posameznih količin in segmente zanimive za bolj podrobno analizo.

```{r vizualizacija, echo=FALSE, message=FALSE}
source("vizualizacija/vizualizacija.r", encoding = "UTF-8")
```
##Prodaja avtomobilov

Graf prikazuje svetovno prodajo avtomobilov. Opazimo, da se je v času krize prodaja avtomobilov zmanjšala.


```{r histogram1, echo=FALSE, message=FALSE, fig.align='left', fig.cap='Graf svetovne prodaje avtomobilov'}
graf.prodaja
```

```{r histogram2, echo=FALSE, message=FALSE, fig.align='left', fig.cap='Graf svetovne prodaje avtomobilov'}
graf.prodaja2
```

##Uporaba avtomobilov


```{r histogram3, echo=FALSE, message=FALSE, fig.align='left', fig.cap='Graf svetovne prodaje avtomobilov'}
graf.uporaba
```


```{r histogram4, echo=FALSE, message=FALSE, fig.align='left', fig.cap='Graf svetovne prodaje avtomobilov'}
graf.uporaba2
```

##Proizvodnja atomobilov

```{r histogram5, echo=FALSE, message=FALSE, fig.align='left', fig.cap='Graf svetovne prodaje avtomobilov'}
graf.proizvodnja
```


```{r histogram6, echo=FALSE, message=FALSE, fig.align='left', fig.cap='Graf svetovne prodaje avtomobilov'}
graf.proizvodnja2
```


```{r zemljevid, echo=FALSE, fig.align='left', fig.cap='Zemljevid proizvodnje avtomobilov v letu 2015',fig.width=10,fig.height=12}
svet.product
```


# Napredna analiza podatkov



